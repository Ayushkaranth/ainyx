import { useCallback, useEffect, useMemo } from 'react';import {   ReactFlow,   Background,   Controls,   useNodesState,   useEdgesState,   Edge,   OnNodesChange,   OnEdgesChange,   NodeChange,   EdgeChange,  OnNodesDelete,  addEdge,       Connection,    OnConnect    } from '@xyflow/react';import '@xyflow/react/dist/style.css';import { useAppStore } from '../../lib/store';import { AppNode } from '../../types';import { ServiceNode } from './ServiceNode';interface FlowCanvasProps { initialNodes: AppNode[]; initialEdges: Edge[]; }export function FlowCanvas({ initialNodes, initialEdges }: FlowCanvasProps) {  const [nodes, setNodes, onNodesChange] = useNodesState<AppNode>(initialNodes);  const [edges, setEdges, onEdgesChange] = useEdgesState<Edge>(initialEdges);  const { setSelectedNode } = useAppStore();  const nodeTypes = useMemo(() => ({ custom: ServiceNode }), []);  useEffect(() => { setNodes(initialNodes); setEdges(initialEdges); }, [initialNodes, initialEdges, setNodes, setEdges]);  const onNodeClick = useCallback((_: React.MouseEvent, node: AppNode) => setSelectedNode(node.id), [setSelectedNode]);  const onNodesDelete: OnNodesDelete = useCallback(() => {    setSelectedNode(null);   }, [setSelectedNode]);  const onConnect: OnConnect = useCallback(    (params: Connection) => setEdges((eds) => addEdge(params, eds)),    [setEdges],  );  const handleNodesChange: OnNodesChange<AppNode> = (changes: NodeChange<AppNode>[]) => onNodesChange(changes);  const handleEdgesChange: OnEdgesChange<Edge> = (changes: EdgeChange<Edge>[]) => onEdgesChange(changes);  const defaultEdgeOptions = {    animated: true,    type: 'smoothstep',    style: { stroke: '#71717a', strokeWidth: 2 },   };  return (    <div className="h-full w-full bg-background">      <ReactFlow<AppNode, Edge>         nodes={nodes}         edges={edges}         nodeTypes={nodeTypes}        onNodesChange={handleNodesChange}         onEdgesChange={handleEdgesChange}         onConnect={onConnect}                  onNodeClick={onNodeClick}         onNodesDelete={onNodesDelete}        defaultEdgeOptions={defaultEdgeOptions}         fitView      >        <Background gap={24} size={2} color="#3f3f46" />        <Controls className="bg-card border-border fill-foreground" />      </ReactFlow>    </div>  );}